<!doctype html><html lang=zh-cn data-theme=light><head><meta charset=utf-8><meta name=viewport content="width=device-width"><meta name=theme-color content="#222" media="(prefers-color-scheme: light)"><meta name=generator content="Hugo 0.111.3"><link rel="shortcut icon" type=image/x-icon href=/imgs/icons/favicon_next.ico><link rel=icon type=image/x-icon href=/imgs/icons/favicon_next.ico><link rel=icon type=image/png sizes=16x16 href=/imgs/icons/favicon_next.png><link rel=icon type=image/png sizes=32x32 href=/imgs/icons/favicon_next.png><link rel=apple-touch-icon sizes=180x180 href=/imgs/icons/favicon_next.png><meta itemprop=name content="3.åˆ›å»ºå¸¦å‚beanå¯¹è±¡"><meta itemprop=description content="3.åˆ›å»ºå¸¦å‚beanå¯¹è±¡"><meta itemprop=datePublished zgotmplz><meta itemprop=dateModified zgotmplz><meta itemprop=image content="https://zzzicode.github.io/imgs/avatar.png"><meta itemprop=keywords content="spring,æºç "><meta property="og:type" content="article"><meta property="og:title" content="3.åˆ›å»ºå¸¦å‚beanå¯¹è±¡"><meta property="og:description" content="3.åˆ›å»ºå¸¦å‚beanå¯¹è±¡"><meta property="og:image" content="/imgs/avatar.png"><meta property="og:image:width" content="312"><meta property="og:image:height" content="312"><meta property="og:image:type" content="image/jpeg/png/svg/jpg"><meta property="og:url" content="https://zzzicode.github.io/post/3.%E5%88%9B%E5%BB%BA%E5%B8%A6%E5%8F%82bean%E5%AF%B9%E8%B1%A1/"><meta property="og:site_name" content="zzziçš„å°ç«™"><meta property="og:locale" content="zh-CN"><meta property="article:author" content="zzzi"><meta property="article:published_time" content="2023-10-30 20:51:28 +0800 CST"><meta property="article:modified_time" content="2023-10-30 20:51:28 +0800 CST"><link type=text/css rel=stylesheet href=https://cdn.staticfile.org/font-awesome/6.1.2/css/all.min.css><link type=text/css rel=stylesheet href=https://cdn.staticfile.org/animate.css/3.1.1/animate.min.css><link type=text/css rel=stylesheet href=https://cdn.staticfile.org/viewerjs/1.11.0/viewer.min.css><link rel=stylesheet href=/css/main.min.4b7f3d9c4ef8db1505229a7dcd2c4e3ab17cd4960dd8a78b503c013770ad56a6.css><style type=text/css>.post-footer,.flinks-list-footer hr:after{content:"~ æˆ‘å¯æ˜¯æœ‰åº•çº¿çš„å“Ÿ ~"}</style><script type=text/javascript>(function(){localDB={set:function(e,t,n){if(n===0)return;const s=new Date,o=n*864e5,i={value:t,expiry:s.getTime()+o};localStorage.setItem(e,JSON.stringify(i))},get:function(e){const t=localStorage.getItem(e);if(!t)return void 0;const n=JSON.parse(t),s=new Date;return s.getTime()>n.expiry?(localStorage.removeItem(e),void 0):n.value}},theme={active:function(){const e=localDB.get("theme");if(e==null)return;theme.toggle(e),window.matchMedia("(prefers-color-scheme: dark)").addListener(function(e){theme.toggle(e.matches?"dark":"light")})},toggle:function(e){document.documentElement.setAttribute("data-theme",e),localDB.set("theme",e,2);const t=document.querySelector("iframe.giscus-frame");if(t){const n={setConfig:{theme:e}};t.contentWindow.postMessage({giscus:n},"https://giscus.app")}}},theme.active()})(window)</script><script class=next-config data-name=page type=application/json>{"comments":false,"isHome":false,"isPage":true,"math":{"js":{"file":"es5/tex-mml-chtml.js","name":"mathjax","version":"3.2.0"},"render":"mathjax"},"path":"3.%E5%88%9B%E5%BB%BA%E5%B8%A6%E5%8F%82bean%E5%AF%B9%E8%B1%A1","permalink":"https://zzzicode.github.io/post/3.%E5%88%9B%E5%BB%BA%E5%B8%A6%E5%8F%82bean%E5%AF%B9%E8%B1%A1/","title":"3.åˆ›å»ºå¸¦å‚beanå¯¹è±¡"}</script><script type=text/javascript>document.addEventListener("DOMContentLoaded",()=>{var e=document.createElement("script");e.charset="UTF-8",e.src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js",e.async=!1,e.defer=!0,document.head.appendChild(e),e.onload=function(){NexT.utils.fmtBusuanzi()}})</script><title>3.åˆ›å»ºå¸¦å‚beanå¯¹è±¡ - zzziçš„å°ç«™</title><noscript><link rel=stylesheet href=/css/noscript.css></noscript></head><body itemscope itemtype=http://schema.org/WebPage class=use-motion><div class=headband></div><main class=main><header class=header itemscope itemtype=http://schema.org/WPHeader><div class=header-inner><div class=site-brand-container><div class=site-nav-toggle><div class=toggle aria-label role=button><span class=toggle-line></span>
<span class=toggle-line></span>
<span class=toggle-line></span></div></div><div class=site-meta><a href=/ class=brand rel=start><i class=logo-line></i><h1 class=site-title>zzziçš„å°ç«™</h1><i class=logo-line></i></a></div><div class=site-nav-right><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class=site-nav><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href=/ class=hvr-icon-pulse rel=section><i class="fa fa-home hvr-icon"></i>é¦–é¡µ</a></li><li class="menu-item menu-item-about"><a href=/about.html class=hvr-icon-pulse rel=section><i class="fa fa-user hvr-icon"></i>å…³äº</a></li><li class="menu-item menu-item-archives"><a href=/archives/ class=hvr-icon-pulse rel=section><i class="fa fa-archive hvr-icon"></i>å½’æ¡£
<span class=badge>217</span></a></li><li class="menu-item menu-item-search"><a role=button class="popup-trigger hvr-icon-pulse"><i class="fa fa-search fa-fw hvr-icon"></i>æœç´¢</a></li></ul></nav><div class=search-pop-overlay><div class="popup search-popup"><div class=search-header><span class=search-icon><i class="fa fa-search"></i></span><div class=search-input-container><input autocomplete=off autocapitalize=off maxlength=80 placeholder=æœç´¢... spellcheck=false type=search class=search-input></div><span class=popup-btn-close role=button><i class="fa fa-times-circle"></i></span></div><div class="search-result-container no-result"><div class=search-result-icon><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></div><div class="toggle sidebar-toggle" role=button><span class=toggle-line></span>
<span class=toggle-line></span>
<span class=toggle-line></span></div><aside class=sidebar><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class=sidebar-nav><li class=sidebar-nav-toc>æ–‡ç« ç›®å½•</li><li class=sidebar-nav-overview>ç«™ç‚¹æ¦‚è§ˆ</li></ul><div class=sidebar-panel-container><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><nav id=TableOfContents><ul><li><a href=#åŸå› >åŸå› </a></li><li><a href=#æ€è·¯>æ€è·¯</a><ul><li><a href=#ç±»çš„è¯´æ˜>ç±»çš„è¯´æ˜</a></li><li><a href=#beançš„åˆ›å»ºå’Œè·å–>beançš„åˆ›å»ºå’Œè·å–</a></li></ul></li><li><a href=#æ€»ç»“>æ€»ç»“</a></li></ul></nav></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author site-overview-item animated" itemprop=author itemscope itemtype=http://schema.org/Person><img class=site-author-image itemprop=image alt=zzzi src=/imgs/img-lazy-loading.gif data-src=/imgs/avatar.png><p class=site-author-name itemprop=name>zzzi</p><div class=site-description itemprop=description>make_tuple("å·¥ä½œ","è®ºæ–‡")</div></div><div class="site-state-wrap site-overview-item animated"><nav class=site-state><div class="site-state-item site-state-posts"><a href=/archives/><span class=site-state-item-count>217</span>
<span class=site-state-item-name>æ—¥å¿—</span></a></div><div class="site-state-item site-state-categories"><a href=/categories/><span class=site-state-item-count>5</span>
<span class=site-state-item-name>åˆ†ç±»</span></a></div><div class="site-state-item site-state-tags"><a href=/tags/><span class=site-state-item-count>46</span>
<span class=site-state-item-name>æ ‡ç­¾</span></a></div></nav></div><div class="links-of-social site-overview-item animated"><span class=links-of-social-item><a href=https://github.com/zzziCode title="Github â†’ https://github.com/zzziCode" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-github fa-fw hvr-icon"></i>
Github</a></span></div><div class="cc-license animated" itemprop=license><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh class=cc-opacity rel=noopener target=_blank title=å…±äº«çŸ¥è¯†><img src=/imgs/img-lazy-loading.gif data-src=/imgs/cc/big/by_nc_sa.svg alt=å…±äº«çŸ¥è¯†></a></div><div class="links-of-blogroll site-overview-item animated"><div class=links-of-blogroll-title><i class="fa fa-globe fa-fw"></i>
å‹æƒ…é“¾æ¥</div><ul class=links-of-blogroll-list><li class=links-of-blogroll-item><a href=https://gitee.com/hugo-next/hugo-theme-next title=https://gitee.com/hugo-next/hugo-theme-next target=_blank>Hugo-NexT</a></li><li class=links-of-blogroll-item><a href=https://lisenhui.cn title=https://lisenhui.cn target=_blank>å‡¡æ¢¦æ˜Ÿå°˜</a></li></ul></div></div></div></div></aside><div class=sidebar-dimmer></div></header><div class=tool-buttons><div id=toggle-theme class=button title=æ·±æµ…æ¨¡å¼åˆ‡æ¢><i class="fas fa-adjust"></i></div><div class=back-to-top role=button title=è¿”å›é¡¶éƒ¨><i class="fa fa-arrow-up"></i>
<span>0%</span></div></div><div class=reading-progress-bar></div><script type=text/javascript src=//sidecar.gitter.im/dist/sidecar.v1.js async></script>
<script type=text/javascript>((window.gitter={}).chat={}).options={room:"hugo-next/community"}</script><noscript><div class=noscript-warning>Theme NexT works best with JavaScript enabled</div></noscript><div class="main-inner post posts-expand"><div class=post-block><article itemscope itemtype=http://schema.org/Article class=post-content lang><link itemprop=mainEntityOfPage href=https://zzzicode.github.io/post/3.%E5%88%9B%E5%BB%BA%E5%B8%A6%E5%8F%82bean%E5%AF%B9%E8%B1%A1/><span hidden itemprop=author itemscope itemtype=http://schema.org/Person><meta itemprop=image content="/imgs/avatar.png"><meta itemprop=name content="zzzi"></span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization><meta itemprop=name content="zzzi"><meta itemprop=description content="make_tuple(&#34;å·¥ä½œ&#34;,&#34;è®ºæ–‡&#34;)"></span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork><meta itemprop=name content="3.åˆ›å»ºå¸¦å‚beanå¯¹è±¡"><meta itemprop=description content="3.åˆ›å»ºå¸¦å‚beanå¯¹è±¡"></span><header class=post-header><h1 class=post-title itemprop="name headline">3.åˆ›å»ºå¸¦å‚beanå¯¹è±¡</h1><div class=post-meta-container><div class=post-meta-items><span class=post-meta-item><span class=post-meta-item-icon><i class="far fa-calendar"></i></span>
<span class=post-meta-item-text title=å‘è¡¨äº>å‘è¡¨äºï¼š</span>
<time title="åˆ›å»ºæ—¶é—´ï¼š2023-10-30 20:51:28 +0800 CST" itemprop="dateCreated datePublished" datetime="2023-10-30 20:51:28 +0800 CST">2023-10-30</time></span>
<span class=post-meta-item><span class=post-meta-item-icon><i class="far fa-folder-open"></i></span>
<span class=post-meta-item-text title=åˆ†ç±»äº>åˆ†ç±»äºï¼š</span>
<span itemprop=about itemscope itemtype=http://schema.org/Thing><a href=/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0 itemprop=url rel=index><span itemprop=name>å­¦ä¹ ç¬”è®°</span></a></span></span></div><div class=post-meta-items><span class=post-meta-item title=å­—æ•°><span class=post-meta-item-icon><i class="far fa-file-word"></i></span>
<span class=post-meta-item-text>å­—æ•°ï¼š</span>
<span>3658</span></span>
<span class=post-meta-item title=é˜…è¯»><span class=post-meta-item-icon><i class="far fa-clock"></i></span>
<span class=post-meta-item-text>é˜…è¯»ï¼š&ap;</span>
<span>8åˆ†é’Ÿ</span></span></div></div></header><div class="post-body autonumber" itemprop=articleBody><blockquote><p>ğŸˆ 3.åˆ›å»ºå¸¦å‚beanå¯¹è±¡</p></blockquote><p>æœ¬æ–‡ä¸»è¦æ˜¯åœ¨ä¸Šä¸€ç« çš„åŸºç¡€ä¸Šå¯¹ä¸Šä¸€ç« ä¸­ä»£ç å­˜åœ¨çš„é—®é¢˜è¿›è¡Œæ”¹é€ ï¼Œä¸Šä¸€ç« ä¸­å°†beanå¯¹è±¡çš„åˆ›å»ºäº¤ç»™äº†IOCå®¹å™¨ï¼Œåˆ©ç”¨åå°„åˆ›å»ºbeanå¯¹è±¡å¹¶ä¿å­˜åˆ°IOCå®¹å™¨ä¸­ï¼Œä½†æ˜¯å¿½ç•¥äº†ä¸€ç‚¹ï¼Œä¸Šç« ä¸­ä»£ç åªèƒ½åˆ›å»ºä¸æºå¸¦å‚æ•°çš„beanå¯¹è±¡ï¼Œæ‰€ä»¥è¿™ä¸€ç« ä¸»è¦è§£å†³çš„é—®é¢˜å°±æ˜¯åˆ›å»ºæœ‰å‚æ•°çš„beanå¯¹è±¡ï¼Œæ­£å¸¸çš„springåˆ›å»ºå¸¦å‚çš„beanå¯¹è±¡æ—¶ï¼Œå‚æ•°åº”è¯¥æ³¨å†Œåˆ°äº†BeanDefinitionä¸­ï¼Œç„¶åå…ˆåˆ›å»ºç„¶åå±æ€§å¡«å……ï¼Œä½†æ˜¯æœ¬èŠ‚ä¸­æˆ‘ä»¬ç›´æ¥ä¸€æ­¥åˆ°ä½ï¼Œç®€åŒ–beançš„åˆ›å»ºè¿‡ç¨‹ã€‚å…·ä½“çš„ä»£ç åœ¨
<a href=https://github.com/zzziCode/small-spring.git title=ä»“åº“ rel="noopener external nofollow noreferrer" target=_blank class=exturl>ä»“åº“
<i class="fa fa-external-link-alt"></i>
</a>ä¸­</p><h2 id=åŸå› >åŸå› 
<a class=header-anchor href=#%e5%8e%9f%e5%9b%a0></a></h2><p>â€‹ ä¸ºä»€ä¹ˆä¸Šä¸€ç« ä¸­åªèƒ½åˆ›å»ºä¸å¸¦å‚æ•°çš„beanå¯¹è±¡å‘¢ï¼Œä¸»è¦é—®é¢˜å‡ºç°åœ¨<code>createBean</code>å‡½æ•°ä¸­ï¼Œå¯ä»¥æŸ¥çœ‹<code>createBean</code>çš„ä»£ç å°±èƒ½å¤Ÿå‘ç°é—®é¢˜ï¼š</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>protected</span> Object <span style=color:#a6e22e>createBean</span><span style=color:#f92672>(</span>String beanName<span style=color:#f92672>,</span> BeanDefinition beanDefinition<span style=color:#f92672>)</span> <span style=color:#66d9ef>throws</span> BeansException <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    Object bean<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>try</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>//åˆ©ç”¨åå°„,æ ¹æ®ä¼ é€’æ¥çš„ç±»ä¿¡æ¯åˆ›å»ºä¸€ä¸ªå®ä¾‹åŒ–å¯¹è±¡
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        bean <span style=color:#f92672>=</span> beanDefinition<span style=color:#f92672>.</span><span style=color:#a6e22e>getBeanClass</span><span style=color:#f92672>().</span><span style=color:#a6e22e>newInstance</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span> <span style=color:#66d9ef>catch</span> <span style=color:#f92672>(</span>InstantiationException <span style=color:#f92672>|</span> IllegalAccessException e<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> BeansException<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Instantiation of bean failed&#34;</span><span style=color:#f92672>,</span> e<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>//åœ¨è¿™é‡Œå°±æ˜¯åˆ›å»ºæˆåŠŸ
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>//è°ƒç”¨ç»§æ‰¿è‡ªDefaultSingletonBeanRegistryä¸­çš„addSingletonæ–¹æ³•å°†è¿™ä¸ªå¯¹è±¡ä¿å­˜åˆ°å®¹å™¨ä¸­
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    addSingleton<span style=color:#f92672>(</span>beanName<span style=color:#f92672>,</span> bean<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>//å°†åˆ›å»ºçš„beanè¿”å›ï¼Œè¿”å›å€¼ç”¨äºgetBeançš„è¿”å›å€¼
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>return</span> bean<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></td></tr></table></div></div><p>â€‹ åœ¨ç¬¬å…­è¡Œä¸­ï¼Œç›´æ¥åˆ©ç”¨åå°„ï¼Œè°ƒç”¨<code>newInstance</code>æ–¹æ³•åˆ›å»ºä¸€ä¸ªbeanå¯¹è±¡ï¼Œæ­¤å¤„è°ƒç”¨æ—¶å¹¶æ²¡æœ‰<strong>åŒºåˆ†</strong>beanå¯¹è±¡æ˜¯å¦æºå¸¦å‚æ•°ï¼Œå¯¼è‡´åˆ›å»ºå‡ºæ¥çš„beanå¯¹è±¡å…¨éƒ½æ˜¯æ— å‚çš„ï¼Œæ‰€ä»¥éœ€è¦æ”¹è¿›çš„åœ°æ–¹å°±åœ¨è¿™é‡Œï¼Œå°†è¿™é‡Œåˆ›å»ºbeanå¯¹è±¡çš„ä»£ç è¿›è¡Œ<strong>æ‰©å……</strong>ï¼Œæ¥æ”¶beanå¯¹è±¡çš„å‚æ•°ï¼Œå°±å¯ä»¥åœ¨åˆ›å»ºbeanå¯¹è±¡æ—¶åˆ›å»ºæºå¸¦å‚æ•°çš„beanå¯¹è±¡äº†ï¼Œå…¶å®åŸå§‹springæ¡†æ¶ä¸­çš„beanå¯¹è±¡å‚æ•°æ˜¯é€šè¿‡åæœŸå±æ€§æ³¨å…¥å¡«å……çš„ï¼Œè€Œä¸æ˜¯åˆ›å»ºå¼€å§‹å°±æºå¸¦å‚æ•°ã€‚åœ¨è¿™é‡Œä¸ºäº†åˆ›å»ºå¸¦å‚beanå¯¹è±¡ï¼Œå¯¹äºæ„é€ å‡½æ•°çš„é€‰å–å°±éœ€è¦è¿›è¡ŒåŒ¹é…ï¼Œæ ¹æ®ä¼ é€’çš„å‚æ•°åˆ—è¡¨ä»è€Œæ‰¾åˆ°åŒ¹é…çš„æ„é€ å‡½æ•°ï¼Œåˆ›å»ºbeanå¯¹è±¡æ—¶å°†å‚æ•°ä¼ å…¥åŒ¹é…çš„æ„é€ å‡½æ•°å³å¯</p><h2 id=æ€è·¯>æ€è·¯
<a class=header-anchor href=#%e6%80%9d%e8%b7%af></a></h2><p>ä¸ºäº†å®ç°ä¸Šé¢æè¿°çš„ï¼šå¯ä»¥åˆ›å»ºæºå¸¦å‚æ•°çš„beanå¯¹è±¡ï¼Œéœ€è¦è§£å†³ä¸¤ä¸ªé—®é¢˜ï¼š</p><ol><li>å¦‚ä½•æ¥å—æˆ–è€…å¦‚ä½•ä¼ é€’beanå¯¹è±¡çš„å‚æ•°</li><li>å¦‚ä½•å¯¹ç°æœ‰é¡¹ç›®åˆç†çš„æ‰©å±•ï¼Œå®ç°å¯ä»¥åˆ›å»ºæºå¸¦å‚æ•°çš„beanå¯¹è±¡</li></ol><p>â€‹ ä¸ºäº†è§£å†³ç¬¬ä¸€ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è·å–beanå¯¹è±¡çš„æ—¶å€™å°±ä¼ é€’ä¸€äº›å‚æ•°ï¼Œè¿™æ ·æ—¢å¯ä»¥ç”¨å‚æ•°åŒºåˆ†è·å–çš„å¯¹è±¡æ˜¯è°ï¼Œåˆå¯ä»¥åœ¨æ²¡æœ‰ç›®æ ‡beanå¯¹è±¡æ—¶ï¼Œæ ¹æ®ä¼ é€’çš„å‚æ•°åˆ›å»ºä¸€ä¸ªç›®æ ‡beanå¯¹è±¡ã€‚è€Œå¯¹å¤–æš´éœ²çš„è·å–beanå¯¹è±¡çš„æ¥å£ä¸º<code>getBean</code>ï¼Œæ‰€ä»¥ç¬¬ä¸€ä¸ªé—®é¢˜çš„çªç ´å£å°±åœ¨<code>getBean</code>å‡½æ•°ä¸Š</p><p>â€‹ ä¸ºäº†è§£å†³ç¬¬äºŒä¸ªé—®é¢˜ï¼Œå¯ä»¥åœ¨<code>createBean</code>çš„å‡½æ•°ä¸­è¿›è¡Œæ”¹é€ ï¼Œå¼•å…¥ä¸€ä¸ªæ‰©å±•ç±»ï¼Œç”¨æ¥å®ç°æ ¹æ®ä¸åŒçš„å‚æ•°åŒ¹é…ä¸åŒçš„æ„é€ å‡½æ•°ï¼Œåˆ›å»ºä¸åŒçš„beanå¯¹è±¡ï¼Œå¯¹äºåˆ›å»ºbeanå¯¹è±¡æ¥è¯´ï¼Œæœ‰ä¸¤ç§æ–¹å¼ï¼š</p><ol><li>åˆ©ç”¨<code>JDK</code>çš„<strong>åå°„</strong>æœºåˆ¶</li><li>åˆ©ç”¨<code>CGlib</code>çš„<strong>å­—èŠ‚ç </strong>æœºåˆ¶</li></ol><p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å•ç‹¬å»ºç«‹ä¸€ä¸ªå®ä¾‹åŒ–æ¨¡å—ï¼Œä¸“é—¨ç”¨æ¥åˆ›å»ºbeanå¯¹è±¡ï¼Œæ ¹æ®æ¥å—çš„å‚æ•°ä¸åŒåˆ›å»ºä¸åŒçš„beanå¯¹è±¡ï¼Œå¯¹å¤–æš´éœ²ä¸€ä¸ªåˆ›å»ºbeanå¯¹è±¡çš„æ¥å£ï¼Œç„¶å<code>createBean</code>æ–¹æ³•ä¸­<strong>ä¸æ˜¯ç®€å•çš„è°ƒç”¨<code>newInstance</code>æ–¹æ³•</strong>ï¼Œè€Œæ˜¯è°ƒç”¨è¿™ä¸ªå°è£…å¥½çš„æ¥å£æ¥åˆ›å»ºç›®æ ‡å¯¹è±¡ï¼Œå½¢æˆçš„ç»“æ„å›¾ä¸ºï¼š</p><img src=https://zzzi-img-1313100942.cos.ap-beijing.myqcloud.com/img/202310311241940.png alt="å›¾ 4-1" style=zoom:50%><p>å½¢æˆçš„æ–°çš„ç±»å›¾å¦‚ä¸‹ï¼Œå¯ä»¥å‘ç°åªæ˜¯å¤šäº†å·¦è¾¹çš„ä¸€ä¸ªå®ä¾‹åŒ–æ¨¡å—ï¼Œç„¶ååœ¨åŸæœ‰çš„ç±»ç»“æ„çš„åŸºç¡€ä¸Šå¢åŠ äº†ä¸€äº›æ–¹æ³•ï¼Œä¸»è¦æ˜¯å¯¹å¤–æä¾›çš„æ¥å£å¯ä»¥æ¥å—beanå¯¹è±¡çš„å‚æ•°äº†ï¼Œå¹¶ä¸”è·å–beanå¯¹è±¡å¯ä»¥ä¼ é€’å‚æ•°</p><p><img src=/imgs/img-lazy-loading.gif data-src=https://zzzi-img-1313100942.cos.ap-beijing.myqcloud.com/img/202310311248959.png alt=image-20231031124847218></p><p>åœ¨è¿™ä¸ªç±»ç»“æ„å›¾çš„åŸºç¡€ä¸Šï¼Œå¯¹å˜åŒ–çš„ç±»è¿›è¡Œè¯´æ˜ï¼Œæ²¡æœ‰æè¿°çš„éƒ¨åˆ†è¯·å‚è€ƒç¬¬äºŒç« çš„
<a href=https://zzzicode.github.io/post/small_spring02/ title=æ–‡æ¡£ rel="noopener external nofollow noreferrer" target=_blank class=exturl>æ–‡æ¡£
<i class="fa fa-external-link-alt"></i></a></p><h3 id=ç±»çš„è¯´æ˜>ç±»çš„è¯´æ˜
<a class=header-anchor href=#%e7%b1%bb%e7%9a%84%e8%af%b4%e6%98%8e></a></h3><ol><li><p><code>InstantiationStrategy</code>ï¼šæ˜¯ä¸€ä¸ªæ¥å£ï¼Œä¸»è¦æä¾›äº†åˆ›å»ºå¸¦å‚çš„beanå¯¹è±¡çš„æ¥å£<code>instantiate(BeanDefinition beanDefinition, String beanName, Constructor ctor, Object[] args)</code>ï¼Œå››ä¸ªå‚æ•°çš„å«ä¹‰åˆ†åˆ«ä»£è¡¨beanå¯¹è±¡çš„ç±»ä¿¡æ¯ï¼Œbeanå¯¹è±¡çš„åç§°ï¼Œåˆ›å»ºbeanå¯¹è±¡ç”¨åˆ°çš„æ„é€ å‡½æ•°ï¼Œæ„é€ å‡½æ•°ä¸­çš„å‚æ•°ã€‚åœ¨<code>createBean</code>æ–¹æ³•ä¸­è°ƒç”¨è¿™ä¸ªæ–¹æ³•ä¹‹åï¼Œå°±å¯ä»¥å¾—åˆ°æºå¸¦å‚æ•°çš„beanå¯¹è±¡ï¼Œæ¥å£çš„ç»“æ„ä¸ºï¼š</p><p><img src=/imgs/img-lazy-loading.gif data-src=https://zzzi-img-1313100942.cos.ap-beijing.myqcloud.com/img/202310311318726.png alt=image-20231031125857597></p><blockquote><p>è¿™æ˜¯æœ¬ç« èŠ‚çš„æ ¸å¿ƒæ¥å£ï¼Œæœ‰ä¸¤ä¸ªå®ç°ç±»ï¼Œä»è€Œæœ‰ä¸¤ç§åˆ›å»ºå¸¦å‚beanå¯¹è±¡çš„æ–¹å¼</p></blockquote></li><li><p><code>SimpleInstantiationStrategy</code>ï¼šæ˜¯<code>InstantiationStrategy</code>çš„å…¶ä¸­ä¸€ä¸ªå®ç°ç±»ï¼Œä¹Ÿæ˜¯é¡¹ç›®ä¸­ç¬¬ä¸€ä¸ªå®ä¾‹åŒ–beanå¯¹è±¡çš„<strong>ç­–ç•¥ç±»</strong>ã€‚å†…éƒ¨ä½¿ç”¨JDKçš„<strong>åå°„</strong>æœºåˆ¶æ¥åˆ›å»ºæºå¸¦å‚æ•°çš„beanå¯¹è±¡ï¼Œç±»çš„ç»“æ„ä¸ºï¼š</p><p><img src=/imgs/img-lazy-loading.gif data-src=https://zzzi-img-1313100942.cos.ap-beijing.myqcloud.com/img/202310311318727.png alt=image-20231031125924252></p></li><li><p><code>CglibSubclassingInstantiationStrategy</code>ï¼šæ˜¯<code>InstantiationStrategy</code>çš„å¦å¤–ä¸€ä¸ªå®ç°ç±»ï¼Œä¹Ÿæ˜¯é¡¹ç›®ä¸­ç¬¬äºŒä¸ªå®ä¾‹åŒ–beanå¯¹è±¡çš„<strong>ç­–ç•¥ç±»</strong>ã€‚å†…éƒ¨ä½¿ç”¨äº†ASM<strong>å­—èŠ‚ç </strong>æ¡†æ¶æ¥åˆ›å»ºæºå¸¦å‚æ•°çš„beanå¯¹è±¡ï¼Œç±»çš„ç»“æ„ä¸ºï¼š</p><p><img src=/imgs/img-lazy-loading.gif data-src=https://zzzi-img-1313100942.cos.ap-beijing.myqcloud.com/img/202310311318728.png alt=image-20231031125940874></p><blockquote><p>æ³¨æ„ï¼šè¦ä½¿ç”¨CGlibåˆ›å»ºbeanå¯¹è±¡ï¼Œéœ€è¦å¼•å…¥cglibçš„ä¾èµ–</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#f92672>&lt;dependency&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;groupId&gt;</span>cglib<span style=color:#f92672>&lt;/groupId&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;artifactId&gt;</span>cglib<span style=color:#f92672>&lt;/artifactId&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;version&gt;</span>3.3.0<span style=color:#f92672>&lt;/version&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;/dependency&gt;</span>
</span></span></code></pre></td></tr></table></div></div></blockquote></li><li><p><code>AbstractAutowireCapableBeanFactory</code>ï¼šåˆ›å»ºbeanå¯¹è±¡çš„ç±»ï¼Œåœ¨åŸæœ‰çš„åŸºç¡€ä¸Šä¿å­˜äº†ä¸€ä¸ªæˆå‘˜å˜é‡ï¼Œæ¥ä»£è¡¨å½“å‰ä½¿ç”¨å“ªä¸€ç§å®ä¾‹åŒ–ç­–ç•¥ï¼Œé»˜è®¤ä½¿ç”¨çš„æ˜¯<strong>CGlib</strong>çš„ç­–ç•¥ï¼Œå¹¶ä¸”createBeanæ–¹æ³•ä¸­ä¸å†æ˜¯ç›´æ¥åˆ›å»ºbeanå¯¹è±¡ï¼Œè€Œæ˜¯è°ƒç”¨äº†ä¸€ä¸ª<code>createBeanInstance</code>æ–¹æ³•ï¼ŒåŸå…ˆçš„ç±»çš„ç»“æ„ä¸ºï¼š</p><p><img src=/imgs/img-lazy-loading.gif data-src=https://zzzi-img-1313100942.cos.ap-beijing.myqcloud.com/img/202310301057549.png alt=image-20231030102532007></p><p>æ–°çš„ç±»çš„ç»“æ„ä¸ºï¼š</p><p><img src=/imgs/img-lazy-loading.gif data-src=https://zzzi-img-1313100942.cos.ap-beijing.myqcloud.com/img/202310311318729.png alt=image-20231031130058902></p><p>çº¢è‰²åœˆèµ·æ¥çš„éƒ¨åˆ†æ˜¯æ–°å¢çš„é‡ç‚¹ï¼Œå®ç°äº†æŒ‰ç…§æŒ‡å®šçš„ç­–ç•¥åˆ›å»ºå¸¦å‚çš„beanå¯¹è±¡çš„åŠŸèƒ½</p></li><li><p><code>AbstractBeanFactory</code>ï¼šåŸæ¥çš„ç±»ä¸­ï¼ŒgetBeanæ–¹æ³•ä¸­å…ˆå°è¯•ç›´æ¥è·å–beanå¯¹è±¡ï¼Œå¦åˆ™ç›´æ¥è°ƒç”¨<code>createBean</code>æ–¹æ³•åˆ›å»ºbeanå¯¹è±¡ï¼Œç°åœ¨å°†è¿™äº›å·¥ä½œäº¤ç»™äº†<code>doGetBean</code>æ–¹æ³•ï¼Œåˆå°è£…äº†ä¸€å±‚ï¼Œæ–°çš„ç»“æ„ä¸ºï¼š</p><p><img src=/imgs/img-lazy-loading.gif data-src=https://zzzi-img-1313100942.cos.ap-beijing.myqcloud.com/img/202310311318731.png alt=image-20231031130335141></p><p>å°†è·å–Beançš„æ“ä½œ<strong>æŠ½å–</strong>å‡ºæ¥å˜æˆdoGetBeanæ–¹æ³•çš„ç›®çš„æ˜¯ä¸ºäº†å‡å°ä»£ç é‡ï¼Œå› ä¸ºä¸¤ä¸ªé‡è½½ç‰ˆæœ¬çš„getBeanæ–¹æ³•éƒ½éœ€è¦è·å–beanå¯¹è±¡ï¼Œåªæ˜¯ä¼ é€’çš„å‚æ•°ä¸ä¸€æ ·ï¼Œæ‰€ä»¥å°†è¿™éƒ¨åˆ†ä»£ç æŠ½å–å‡ºæ¥ï¼ŒåæœŸè°ƒç”¨æ—¶ä¼ é€’çš„å‚æ•°ä¸ä¸€æ ·å³å¯ï¼š</p><p><img src=/imgs/img-lazy-loading.gif data-src=https://zzzi-img-1313100942.cos.ap-beijing.myqcloud.com/img/202310311334811.png alt=image-20231031133443399></p></li></ol><blockquote><p>ä»¥ä¸Šå°±æ˜¯æœ¬èŠ‚ä¸­çš„ä»£ç æ¯”ä¸ä¸Šä¸€èŠ‚å¤šå‡ºæ¥æˆ–è€…ä¿®æ”¹çš„éƒ¨åˆ†ï¼Œç›®çš„æ˜¯ä¸ºäº†å®ç°åˆ›å»ºå¸¦å‚çš„beanå¯¹è±¡</p></blockquote><h3 id=beançš„åˆ›å»ºå’Œè·å–>beançš„åˆ›å»ºå’Œè·å–
<a class=header-anchor href=#bean%e7%9a%84%e5%88%9b%e5%bb%ba%e5%92%8c%e8%8e%b7%e5%8f%96></a></h3><p>ä¸ºäº†è·å¾—å¸¦å‚æ•°çš„beanï¼Œæœ€å¤–å±‚è·å–beançš„æ—¶å€™å°±éœ€è¦ä¼ é€’å‚æ•°ï¼Œæ ¹æ®å‚æ•°çš„ä¸åŒæ¥åŒ¹é…ä¸åŒçš„beanå¯¹è±¡ï¼Œåˆå§‹çŠ¶æ€ä¸‹ï¼Œä¼šåˆ©ç”¨ä¼ é€’æ¥çš„å‚æ•°åˆ›å»ºä¸€ä¸ªæ–°çš„å¸¦å‚çš„beanå¯¹è±¡ä¿å­˜åˆ°IOCå®¹å™¨ä¸­å¹¶è¿”å›ï¼Œæ•´ä½“çš„æµç¨‹ä¸ºï¼š</p><img src=https://zzzi-img-1313100942.cos.ap-beijing.myqcloud.com/img/202310311313921.png alt=æœªå‘½åæ–‡ä»¶ style=zoom:67%><p>getBeanæ–¹æ³•ä¸­å¯ä»¥æºå¸¦beançš„å‚æ•°ï¼Œå¹¶ä¸”åœ¨åˆ›å»ºbeanå®ä¾‹çš„æ—¶å€™ï¼Œéœ€è¦æ‰¾åˆ°åŒ¹é…çš„æ„é€ å‡½æ•°ï¼Œå…·ä½“çš„å‡½æ•°é€»è¾‘åœ¨createBeanInstanceä¸­</p><p>ä¸Šä¸€ç« ä¸­è·å–beanå¯¹è±¡çš„æµç¨‹ä¸ºï¼š</p><img src=https://zzzi-img-1313100942.cos.ap-beijing.myqcloud.com/img/202310301144543.png alt=image-20231030114408629 style=zoom:50%><p>å¯ä»¥çœ‹å‡ºï¼Œç›¸æ¯”äºä¸Šä¸€ç« ï¼Œåœ¨<code>createBean</code>çš„æ—¶å€™å¢åŠ äº†ä¸¤æ­¥ï¼Œæœ¬ç« ä¸­æŒ‰ç…§å®ä¾‹åŒ–ç­–ç•¥ï¼Œæ ¹æ®æ¥æ”¶çš„å‚æ•°æ¥åˆ›å»ºå¸¦å‚çš„beanå¯¹è±¡ï¼Œå…¶æ•´ä½“æ­¥éª¤è¿˜æ˜¯ä¸ä¸Šä¸€ç« <strong>ä¿æŒä¸€è‡´</strong></p><p>â€‹ æ ¸å¿ƒå°±æ˜¯å¦‚ä½•åˆ©ç”¨ä¼ é€’æ¥çš„å‚æ•°æ¥åˆ›å»ºå¸¦å‚beanå¯¹è±¡ï¼Œä¸»è¦æ˜¯åœ¨å¢åŠ çš„ä¸¤ä¸ªæ–¹æ³•<code>createBeanInstance</code>å’Œ<code>instantiate</code>ä¸­ï¼Œå‰ä¸€ä¸ªæ–¹æ³•é€šè¿‡å‚æ•°åˆ—è¡¨çš„ç±»å‹åŒ¹é…åˆ°<strong>ç›®æ ‡æ„é€ å‡½æ•°</strong>ï¼Œç„¶åå°†ç›®æ ‡æ„é€ å‡½æ•°ä¼ é€’ç»™<code>instantiate</code>æ–¹æ³•ï¼Œåœ¨<code>instantiate</code>æ–¹æ³•ä¸­å®Œæˆåˆ›å»ºï¼Œ<code>createBeanInstance</code>æ–¹æ³•çš„ä»£ç å¦‚ä¸‹ï¼š</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">36
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>private</span> Object <span style=color:#a6e22e>createBeanInstance</span><span style=color:#f92672>(</span>BeanDefinition beanDefinition<span style=color:#f92672>,</span> String beanName<span style=color:#f92672>,</span> Object<span style=color:#f92672>[]</span> args<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>//å¦‚æœå‚æ•°åˆ—è¡¨ä¸ºç©ºï¼Œç›´æ¥è°ƒç”¨å®ä¾‹åŒ–ç­–ç•¥åˆ›å»ºæ— å‚å¯¹è±¡å¹¶è¿”å›
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>args <span style=color:#f92672>==</span> <span style=color:#66d9ef>null</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> getInstantiationStrategy<span style=color:#f92672>().</span><span style=color:#a6e22e>instantiate</span><span style=color:#f92672>(</span>beanDefinition<span style=color:#f92672>,</span> beanName<span style=color:#f92672>,</span> <span style=color:#66d9ef>null</span><span style=color:#f92672>,</span> <span style=color:#66d9ef>null</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>//åœ¨è¿™é‡Œè¯´æ˜éœ€è¦åˆ›å»ºå¸¦å‚beanå¯¹è±¡
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>//1.å°è¯•æ‰¾åˆ°ç›®æ ‡æ„é€ å‡½æ•°
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    Constructor constructorToUse <span style=color:#f92672>=</span> <span style=color:#66d9ef>null</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>//è·å–beanå¯¹è±¡çš„ç±»ä¿¡æ¯
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    Class beanClass <span style=color:#f92672>=</span> beanDefinition<span style=color:#f92672>.</span><span style=color:#a6e22e>getBeanClass</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>//è·å–åˆ°è¿™ä¸ªbeanå¯¹è±¡çš„æ‰€æœ‰æ„é€ å‡½æ•°
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    Constructor<span style=color:#f92672>[]</span> declaredConstructors <span style=color:#f92672>=</span> beanClass<span style=color:#f92672>.</span><span style=color:#a6e22e>getDeclaredConstructors</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>//éå†æ‰€æœ‰çš„æ„é€ å‡½æ•°ï¼Œç”¨å‚æ•°åˆ—è¡¨å»åŒ¹é…ï¼Œä»è€Œæ‰¾åˆ°ç›®æ ‡æ„é€ å‡½æ•°
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span>Constructor declaredConstructor <span style=color:#f92672>:</span> declaredConstructors<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>//è·å–åˆ°å½“å‰æ„é€ å‡½æ•°çš„å‚æ•°åˆ—è¡¨
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        Class<span style=color:#f92672>[]</span> parameterTypes <span style=color:#f92672>=</span> declaredConstructor<span style=color:#f92672>.</span><span style=color:#a6e22e>getParameterTypes</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>//å‚æ•°ä¸ªæ•°éƒ½ä¸ä¸€æ ·ï¼Œè‚¯å®šä¸åŒ¹é…,ç»§ç»­æŸ¥æ‰¾ä¸‹ä¸€ä¸ª
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>parameterTypes<span style=color:#f92672>.</span><span style=color:#a6e22e>length</span> <span style=color:#f92672>!=</span> args<span style=color:#f92672>.</span><span style=color:#a6e22e>length</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>continue</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>//å‚æ•°ä¸ªæ•°ä¸€æ ·ï¼Œçœ‹ç±»å‹æ˜¯å¦ä¸€æ ·
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> <span style=color:#f92672>(;</span> i <span style=color:#f92672>&lt;</span> parameterTypes<span style=color:#f92672>.</span><span style=color:#a6e22e>length</span><span style=color:#f92672>;</span> i<span style=color:#f92672>++)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            <span style=color:#75715e>//å‚æ•°åˆ—è¡¨çš„ç±»å‹ä¸åŒ¹é…,ç»§ç»­æœç´¢åˆé€‚çš„æ„é€ å‡½æ•°
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>parameterTypes<span style=color:#f92672>[</span>i<span style=color:#f92672>]</span> <span style=color:#f92672>!=</span> args<span style=color:#f92672>[</span>i<span style=color:#f92672>].</span><span style=color:#a6e22e>getClass</span><span style=color:#f92672>())</span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>break</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>//å‚æ•°åˆ—è¡¨åŒ¹é…åˆ°äº†æœ«å°¾è¯´æ˜æ‰¾åˆ°ç›®æ ‡æ„é€ å‡½æ•°
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>i <span style=color:#f92672>==</span> parameterTypes<span style=color:#f92672>.</span><span style=color:#a6e22e>length</span><span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            constructorToUse <span style=color:#f92672>=</span> declaredConstructor<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>break</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>//åœ¨è¿™é‡Œåˆ›å»ºå¸¦å‚çš„beanå¯¹è±¡
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>return</span> getInstantiationStrategy<span style=color:#f92672>().</span><span style=color:#a6e22e>instantiate</span><span style=color:#f92672>(</span>beanDefinition<span style=color:#f92672>,</span> beanName<span style=color:#f92672>,</span> constructorToUse<span style=color:#f92672>,</span> args<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></td></tr></table></div></div><p>å¯ä»¥çœ‹å‡ºï¼Œæ ¸å¿ƒå°±æ˜¯åˆ©ç”¨åå°„å¾—åˆ°å½“å‰beanå¯¹è±¡çš„æ‰€æœ‰æ„é€ æ–¹æ³•ï¼Œç„¶åå†å¾—åˆ°æ¯ä¸€ä¸ªæ„é€ æ–¹æ³•çš„å‚æ•°åˆ—è¡¨ï¼Œ<strong>å¯¹å‚æ•°åˆ—è¡¨è¿›è¡ŒåŒ¹é…</strong>ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå‚æ•°åŒ¹é…æ—¶ï¼Œç”±äº<code>getBean</code>æ¥å—å‚æ•°æ—¶ä½¿ç”¨çš„æ˜¯<strong>Objectæ•°ç»„</strong>ï¼Œæ‰€ä»¥ä¼ é€’intå‚æ•°æ—¶ä¼šå°†å…¶è½¬æ¢æˆIntegerï¼Œæ•…è€ŒåŒ¹é…å‚æ•°æ—¶ä¼šå‡ºç°é—®é¢˜ï¼Œæ‰€ä»¥beanå¯¹è±¡çš„æ„é€ å‡½æ•°ä¸­ï¼Œ<strong>ä¸ä½¿ç”¨åŸºæœ¬ç±»å‹å­˜å‚¨å‚æ•°</strong>ï¼Œåœ¨çœŸæ­£çš„springä¸­ï¼Œå¹¶ä¸ä½¿ç”¨è¿™ç§æ–¹å¼åˆ›å»ºå¸¦å‚çš„beanå¯¹è±¡ï¼Œè€Œæ˜¯å…ˆåˆ›å»ºå†å±æ€§å¡«å……çš„æ–¹æ³•ï¼Œå±æ€§å¡«å……</p><h2 id=æ€»ç»“>æ€»ç»“
<a class=header-anchor href=#%e6%80%bb%e7%bb%93></a></h2><p>ä¸ºäº†åˆ›å»ºå¸¦å‚æ•°çš„beanï¼Œä¸»è¦æ”¹è¿›äº†<code>getBean</code>æ–¹æ³•å’Œ<code>createBean</code>æ–¹æ³•ï¼Œå‰è€…ä½¿å¾—ç¨‹åºå¯ä»¥æ¥å—beanå¯¹è±¡çš„å‚æ•°ï¼Œåè€…å¯ä»¥åˆ©ç”¨è¿™ä¸ªå‚æ•°åˆ›å»ºå¸¦å‚çš„beanå¯¹è±¡ï¼Œå†…éƒ¨è°ƒç”¨äº†æ–°å¢çš„å®ä¾‹åŒ–æ¨¡å—ï¼Œé»˜è®¤ä½¿ç”¨<code>CGlib</code>çš„æ–¹å¼åˆ›å»ºbeanå¯¹è±¡ï¼Œå‚è€ƒçš„ç±»å›¾å¦‚ä¸‹ï¼š</p><p><img src=/imgs/img-lazy-loading.gif data-src=https://zzzi-img-1313100942.cos.ap-beijing.myqcloud.com/img/202310311318694.png alt="å›¾ 4-2"></p><p>åˆ›å»ºbeanå¯¹è±¡çš„è¿‡ç¨‹ä¸­å­˜åœ¨ä¸€äº›é—®é¢˜ï¼Œä½†æ˜¯æ•´ä½“ä¸Šè¿˜æ˜¯å¯ä»¥åˆ›å»ºå¸¦å‚çš„beanå¯¹è±¡äº†ï¼Œä¸»è¦åŸç†å°±æ˜¯æŒ‰ç…§ä¼ é€’æ¥çš„å‚æ•°æ¥æ‰¾åˆ°ç›®æ ‡æœ‰å‚æ„é€ å‡½æ•°ï¼Œä»è€Œåˆ›å»ºå¸¦å‚beanå¯¹è±¡</p><p>æ€»ç»“æ¥è¯´å°±æ˜¯åšäº†ä¸¤ç‚¹ï¼š</p><ol><li>è·å–beanå¯¹è±¡æ—¶å…è®¸ä¼ é€’å‚æ•°</li><li>åˆ›å»ºbeanå¯¹è±¡æ—¶å…è®¸æ ¹æ®ä¼ é€’æ¥çš„å‚æ•°åˆ—è¡¨æ‰¾åˆ°åŒ¹é…çš„æ„é€ å‡½æ•°ä»è€Œ<strong>ç›´æ¥</strong>åˆ›å»ºå¸¦å‚beanå¯¹è±¡</li></ol></div><footer class=post-footer><div class=post-tags><a href=/tags/spring>spring</a>
<a href=/tags/%e6%ba%90%e7%a0%81>æºç </a></div><div class=addthis_inline_share_toolbox style=text-align:center></div><hr><div class=post-nav><div class="post-nav-next post-nav-item"><a href=/post/jdk%E4%B8%AD%E7%9A%84%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86/ rel=next title=JDKä¸­çš„åŠ¨æ€ä»£ç†><i class="fa fa-chevron-left"></i> JDKä¸­çš„åŠ¨æ€ä»£ç†</a></div><div class="post-nav-prev post-nav-item"><a href=/post/h%E6%8C%87%E6%95%B0/ rel=prev title=HæŒ‡æ•°>HæŒ‡æ•°
<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div></div></main><footer class=footer><div class=footer-inner><div class=copyright>&copy;
<span itemprop=copyrightYear>2023 - 2024</span>
<span class=with-love><i class="fa fa-heart"></i></span>
<span class=author itemprop=copyrightHolder>zzziæä¾›æŠ€æœ¯æ”¯æŒ</span></div></div></footer><script type=text/javascript src=https://cdn.staticfile.org/animejs/3.2.1/anime.min.js defer></script>
<script type=text/javascript src=https://cdn.staticfile.org/viewerjs/1.11.0/viewer.min.js defer></script>
<script class=next-config data-name=main type=application/json>{"bookmark":{"color":"#222","enable":false,"save":"manual"},"copybtn":true,"darkmode":false,"giscus":{"cfg":{"category":"Comments","categoryid":null,"emit":false,"inputposition":"top","mapping":"title","reactions":false,"repo":"username/repo-name","repoid":null,"theme":"preferred_color_scheme"},"js":"https://giscus.app/client.js"},"hostname":"https://zzzicode.github.io/","i18n":{"ds_day":" å¤©å‰","ds_days":" å¤© ","ds_hour":" å°æ—¶å‰","ds_hours":" å°æ—¶ ","ds_just":"åˆšåˆš","ds_min":" åˆ†é’Ÿå‰","ds_mins":" åˆ†é’Ÿ","ds_month":" ä¸ªæœˆå‰","ds_years":" å¹´ ","empty":"æ²¡æœ‰æ‰¾åˆ°ä»»ä½•æœç´¢ç»“æœï¼š${query}","hits":"æ‰¾åˆ° ${hits} ä¸ªæœç´¢ç»“æœ","hits_time":"æ‰¾åˆ° ${hits} ä¸ªæœç´¢ç»“æœï¼ˆç”¨æ—¶ ${time} æ¯«ç§’ï¼‰","placeholder":"æœç´¢..."},"lang":"zh-CN","lazyload":false,"localSearch":{"enable":true,"path":"/searchindexes.xml","preload":false,"topnperarticle":-1,"trigger":"auto","unescape":false},"motion":{"async":true,"enable":true,"transition":{"collheader":"fadeInLeft","postblock":"fadeIn","postbody":"fadeInDown","postheader":"fadeInDown","sidebar":"fadeInUp"}},"postmeta":{"comments":null,"views":null},"root":"/","scheme":"Gemini","sidebar":{"display":"post","offset":12,"padding":18,"position":"right","width":256},"statis":{"enable":true,"plugin":"busuanzi"},"vendor":{"plugins":"qiniu","router":"https://cdn.staticfile.org"},"version":"4.5.3","waline":{"cfg":{"comment":true,"emoji":false,"imguploader":false,"pageview":true,"placeholder":"è¯·æ–‡æ˜å‘è¨€å“Ÿ ãƒ¾(â‰§â–½â‰¦*)o","reaction":true,"reactiontext":["ç‚¹èµ","è¸©ä¸€ä¸‹","å¾—æ„","ä¸å±‘","å°´å°¬","ç¡è§‰"],"reactiontitle":"ä½ è®¤ä¸ºè¿™ç¯‡æ–‡ç« æ€ä¹ˆæ ·ï¼Ÿ","requiredmeta":["nick","mail"],"serverurl":"https://walinejs.comment.lithub.cc","sofa":"å¿«æ¥å‘è¡¨ä½ çš„æ„è§å§ (â‰§âˆ€â‰¦)ã‚","wordlimit":200},"css":{"alias":"waline","file":"dist/waline.css","name":"@waline/client","version":"2.13.0"},"js":{"alias":"waline","file":"dist/waline.js","name":"@waline/client","version":"2.13.0"}}}</script><script type=text/javascript src=/js/main.min.b0e26367f0461fb41ac6f947dc2af3620375dc44aa8945e6c2b1480d342c65d1.js defer></script>
<script type=text/javascript src=/js/math.min.a6ada19a368d85dad9ead2040d86ae561a867fafef89391d1aa2aa5909366509.js defer></script></body></html>